"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6442],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return m}});var o=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(r),m=a,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||n;return r?o.createElement(h,i(i({ref:t},u),{},{components:r})):o.createElement(h,i({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,i=new Array(n);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<n;c++)i[c]=r[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}d.displayName="MDXCreateElement"},3784:function(e,t,r){r.r(t),r.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return p},frontMatter:function(){return n},metadata:function(){return s},toc:function(){return c}});var o=r(3117),a=(r(7294),r(3905));const n={id:"design",title:"Design",description:"This document describes the design philosophy of Kratos and introduces the overall situation and main components of the project.",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},i=void 0,s={unversionedId:"intro/design",id:"intro/design",title:"Design",description:"This document describes the design philosophy of Kratos and introduces the overall situation and main components of the project.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/intro/02-design.md",sourceDirName:"intro",slug:"/intro/design",permalink:"/en/docs/intro/design",draft:!1,editUrl:"https://github.com/go-kratos/go-kratos.dev/edit/main/i18n/en/docusaurus-plugin-content-docs/current/intro/02-design.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"design",title:"Design",description:"This document describes the design philosophy of Kratos and introduces the overall situation and main components of the project.",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},sidebar:"docs",previous:{title:"Overview",permalink:"/en/docs/"},next:{title:"FAQ",permalink:"/en/docs/intro/faq"}},l={},c=[{value:"Design Philosophy",id:"design-philosophy",level:2},{value:"Community",id:"community",level:2},{value:"Why Kratos V2 was completely redesigned",id:"why-kratos-v2-was-completely-redesigned",level:2},{value:"Database/Cache/Message Queue/...",id:"databasecachemessage-queue",level:2},{value:"CLI Tool",id:"cli-tool",level:2},{value:"API",id:"api",level:2},{value:"Metadata",id:"metadata",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Registrar&amp;Discovery",id:"registrardiscovery",level:2},{value:"Log",id:"log",level:2},{value:"Metrics",id:"metrics",level:2},{value:"Tracing",id:"tracing",level:2},{value:"Load Balancing",id:"load-balancing",level:2},{value:"Ratelimit",id:"ratelimit",level:2},{value:"Middleware",id:"middleware",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Examples",id:"examples",level:2}],u={toc:c};function p(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This document describes the design philosophy of Kratos and introduces the overall situation and main components of the project."),(0,a.kt)("h2",{id:"design-philosophy"},"Design Philosophy"),(0,a.kt)("p",null,"Kratos is a microservice framework implemented in Go language. To be more precise, it's more like a toolbox for building microservices in Go. Developers can choose or customize the components according to their own habits to create their own microservices. Kratos is not bound to a specific infrastructure, not limited to a certain registry, or database ORM. So that you can easily integrate any library into your project and work with Kratos."),(0,a.kt)("p",null,"Around this core design concept, we have designed the following project ecology\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos"},"kratos")," Kratos framework core. It mainly includes basic CLI tools, HTTP/gRPC interface generation tools and service life cycle management. Provides components and interface definitions for link tracking, configuration, logging, service discovery, and monitoring."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib"},"contrib")," A series of components such as configuration, logging, service discovery, monitoring, etc. You can use them directly. Or you can refer to their code to adapt the services you need to integrate them into the kratos project."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/aegis"},"aegis")," We put the service availability algorithm (current limit, circuit breaker, etc.) in this independent project. It has few external dependencies, nor does it depend on Kratos. You can easily integrate it into Kratos to improve the usability of the service. Or you can use it directly in any project."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos-layout"},"layout")," A default project template we designed. It contains a project structure, Makefile script and Dockerfile with reference to DDD and clean architecture design. But this project template is not required. You can modify it however you want, or use a project structure of your own design and Kratos will still work. The framework is highly customizable and does not make any assumptions or restrictions on the project structure itself. You can use it according to your own ideas."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/gateway"},"gateway")," This is the API Gateway we just started developing with Go. Later, you can use it as a gateway for your Kratos microservices for the governance of microservice APIs. The project is under construction, please pay attention.")),(0,a.kt)("h2",{id:"community"},"Community"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"GitHub\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos"},"https://github.com/go-kratos")),(0,a.kt)("li",{parentName:"ul"},"Documents\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://go-kratos.dev/"},"https://go-kratos.dev/")),(0,a.kt)("li",{parentName:"ul"},"Wechat\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/issues/682"},"go-kratos Official WeChat Group")),(0,a.kt)("li",{parentName:"ul"},"Discord\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://discord.com/invite/BWzJsUJ"},"go-kratos"))),(0,a.kt)("h2",{id:"why-kratos-v2-was-completely-redesigned"},"Why Kratos V2 was completely redesigned"),(0,a.kt)("p",null,"Those who have paid attention to the kratos project before may know that the v1 version of Kratos has been open source for a long time, and it is also a relatively complete framework. So why not continue to iterate directly based on v1, but start over and launch a completely redesigned v2?"),(0,a.kt)("p",null,"A fall into a ditch makes you wiser."),(0,a.kt)("p",null,"We found that with the continuous iteration of the business and the continuous expansion of the project, the past framework and project structure design led to a gradual increase in the cost of code changes. And there is no reasonable abstraction, which makes it more difficult to test modules, and it is more difficult to adapt and migrate third-party basic libraries. This reduces productivity to some extent."),(0,a.kt)("p",null,"Therefore, we have redesigned the project structure of microservices with reference to a large number of advanced design concepts in the industry such as DDD and Clean Architecture. And this structure will be further iterated with our follow-up research, making it the best practice for microservice project structure."),(0,a.kt)("p",null,"That's right, the new version starts with kratos-layout. Maybe you will feel uncomfortable when you are new to this project structure. But as the project iterates and the code complexity increases, this well-defined structure will keep the project excellent code readability, testability, and satisfactory development efficiency and maintainability."),(0,a.kt)("p",null,"More importantly, this time we want to design and develop this framework for the community. Get more developers to use our framework to be more productive while participating in our projects."),(0,a.kt)("p",null,"So we designed the entire framework as a socket, and we hoped that the entire framework would be lightweight, plug-in, and customizable. For almost every functional module related to microservices, we have designed standardized interfaces, and designed plug-ins for third-party libraries. This makes it possible to quickly integrate arbitrary infrastructure into projects using Kratos. So, no matter what infrastructure your company uses or what specifications you have, you can easily customize Kratos to match your development and production environments."),(0,a.kt)("p",null,"Without destruction there can be no construction. The V2 is a complete overhaul from the inside out. We were unable to tinker on the old version and chose to redesign and develop the new version. At present, the v2 version has also been used in many production environments. We will also continue to iterate and improve this framework. At the same time, all developers are welcome to participate and make it better together."),(0,a.kt)("h2",{id:"databasecachemessage-queue"},"Database/Cache/Message Queue/..."),(0,a.kt)("p",null,"As mentioned earlier, the Kratos framework does not restrict you to use any third-party library for project development, so you can choose a library for integration according to your preference. We will also gradually develop plugins for more widely used third-party libraries."),(0,a.kt)("p",null,"Here is some popular libary:"),(0,a.kt)("p",null,"Database:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://pkg.go.dev/database/sql"},"database/sql")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-gorm/gorm"},"gorm")," "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/ent/ent"},"ent"))),(0,a.kt)("p",null,"Cache:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-redis/redis"},"go-redis")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/gomodule/redigo"},"redigo")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/bradfitz/gomemcache"},"gomemcache"))),(0,a.kt)("p",null,"Message Queue:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/Shopify/sarama"},"sarama")," kafka client"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/segmentio/kafka-go"},"kafka-go"))),(0,a.kt)("p",null,"Want more\uff1f Please visit ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/avelino/awesome-go"},"awesome-go")),(0,a.kt)("h2",{id:"cli-tool"},"CLI Tool"),(0,a.kt)("p",null,"CLI are currently mainly used to create projects from templates, maintain dependency package versions, etc. For more details please visit ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/getting-started/usage"},"Document")),(0,a.kt)("h2",{id:"api"},"API"),(0,a.kt)("p",null,"Kratos uses Protobuf for API definition. Protobuf is a language-neutral data serialization protocol developed by Google. It has the characteristics of clear structure definition, good scalability, small size, and excellent performance, and is widely used in many companies and projects."),(0,a.kt)("p",null,"In a project using Kratos, you will use the following IDL for your interface definition, and use the ",(0,a.kt)("inlineCode",{parentName:"p"},"protoc")," tool to generate the corresponding ",(0,a.kt)("inlineCode",{parentName:"p"},".pb.go")," file, which contains the server and client code generated according to the definition. Then you can register server-side code for use within your own project, or reference client-side code to make remote calls."),(0,a.kt)("p",null,"Kratos only generates the code of the gRPC interface by default. If you need to generate HTTP code, please use ",(0,a.kt)("inlineCode",{parentName:"p"},"option (google.api.http)")," in the proto file to add the definition of the HTTP part before generating it. By default, the HTTP interface will use JSON as the serialization format. If you want to use other serialization formats (form, XML, etc.), please refer to ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/encoding"},"Serialization"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";\n\npackage helloworld.v1;\n\nimport "google/api/annotations.proto";\n\noption go_package = "github.com/go-kratos/kratos-layout/api/helloworld/v1;v1";\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply)  {\n        option (google.api.http) = {\n            get: "/helloworld/{name}"\n        };\n    }\n}\n\n// The request message containing the user\'s name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n')),(0,a.kt)("p",null,"It should be noted that although the API defined by Protobuf is more reliable, the flexibility of the field structure is weaker than that of JSON. Therefore, if you have a file upload interface, or some JSON structure that cannot correspond to proto. You can define these interfaces outside of our API-System, implement as normal ",(0,a.kt)("inlineCode",{parentName:"p"},"http.Handler")," and mount it on the route, or just use ",(0,a.kt)("inlineCode",{parentName:"p"},"struct")," to define your fields. Here is an example of ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/blob/main/examples/http/upload/main.go"},"upload"),"."),(0,a.kt)("h2",{id:"metadata"},"Metadata"),(0,a.kt)("p",null,"For API calls between services, if there is some meta information that needs passing with no expected appearance in the payload message, you can use the Metadata package for field setting and extraction. For more detail, please refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/metadata"},"document")),(0,a.kt)("h2",{id:"error-handling"},"Error Handling"),(0,a.kt)("p",null,"Kratos' ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/tree/main/errors"},"errors")," module provides an error wrapper. The framework also pre-defines a set of ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/blob/main/errors/types.go"},"standard errors")," for use."),(0,a.kt)("p",null,"The design of error handling was settled after a long discussion. The main design concepts are as follows:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"code")," The semantics are similar to the HTTP Status Code (for example, 400 is used for parameter errors), and it is also used as a major type of error. The advantage is that the gateway layer can trigger corresponding policies (retry, current limit, fuse, etc.) according to this code."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"reason")," The specific error code of the service. A readable string that should be unique within the same service."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"message")," Messages are user-readable and can be used as user prompts."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"metadata")," Meta-information, which adds additional extensible information for errors.")),(0,a.kt)("p",null,"Taking the HTTP interface as an example, the structure of the returned error message is as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    // Error code, which is the same as HTTP-status and can be converted to grPC-status in GRPC.\n    "code": 500,\n    // The error cause is defined as the service decision error code. \n    "reason": "USER_NOT_FOUND",\n    // Error messages are user-readable and can be used as user prompts. \n    "message": "invalid argument error",\n    // Error meta-information, which adds additional extensible information for errors.\n    "metadata": {"some-key": "some-value"}\n}\n')),(0,a.kt)("p",null,"In Kratos, you can use proto files to define your business errors, and generate corresponding processing logic and methods through tools.(such as ",(0,a.kt)("inlineCode",{parentName:"p"},"make errors")," used in layout)"),(0,a.kt)("p",null,"Error Definition:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-protobuf"},'syntax = "proto3";\n\npackage api.blog.v1;\nimport "errors/errors.proto";\n\noption go_package = "github.com/go-kratos/kratos/examples/blog/api/v1;v1";\n\nenum ErrorReason {\n  // default error code\n  option (errors.default_code) = 500;\n  \n  // custome error code\n  USER_NOT_FOUND = 0 [(errors.code) = 404];\n  CONTENT_MISSING = 1 [(errors.code) = 400];;\n}\n')),(0,a.kt)("p",null,"Error Creation:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// Created by errors.New()\nerrors.New(500, "USER_NAME_EMPTY", "user name is empty")\n\n// Created by the code that is generated by proto\napi.ErrorUserNotFound("user %s not found", "kratos")\n\n// Passing metadata\nerr := errors.New(500, "USER_NAME_EMPTY", "user name is empty")\nerr = err.WithMetadata(map[string]string{\n    "foo": "bar",\n})\n')),(0,a.kt)("p",null,"Error Assertion:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'err := wrong()\n\n// Asserte by errors.Is()\nif errors.Is(err,errors.BadRequest("USER_NAME_EMPTY","")) {\n    // do something\n}\n\n// Asserte by *Error.Reason and *Error.Code\ne := errors.FromError(err)\nif  e.Reason == "USER_NAME_EMPTY" && e.Code == 500 {\n    // do something\n}\n\n// Asserte by the code that is generated by proto\nif api.IsUserNotFound(err) {\n        // do something\n})\n')),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"Kratos provides a unified interface that supports loading a configuration file and subscribing to its changes.Any configuration source (local or remote) can be adapted by implementing ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/blob/main/config/source.go"},"Source and Watcher")),(0,a.kt)("p",null,"Here is some plugins ready for use:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/blob/main/config/file/file.go"},"file")," built-in"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/config/apollo"},"apollo")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/config/etcd"},"etcd")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/config/kubernetes"},"kubernetes")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/config/nacos"},"nacos"))),(0,a.kt)("h2",{id:"registrardiscovery"},"Registrar&Discovery"),(0,a.kt)("p",null,"Kratos defines a unified registration interface. By implementing ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/blob/main/registry/registry.go"},"Registrar and Discovery"),", you can easily connect Kratos to your registry."),(0,a.kt)("p",null,"Here is some plugins ready for use:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/consul"},"consul")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/discovery"},"discovery")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/etcd"},"etcd")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/kubernetes"},"kubernetes")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/nacos"},"nacos")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/registry/zookeeper"},"zookeeper"))),(0,a.kt)("h2",{id:"log"},"Log"),(0,a.kt)("p",null,"Kratos' logging module consists of two parts:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/blob/main/log/log.go"},"Logger"),": Low-level logging interface. It is used to quickly adapt various log libraries to the framework. Provides only one of the simplest ",(0,a.kt)("inlineCode",{parentName:"li"},"Log")," methods."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/blob/main/log/helper.go"},"Helper"),": Advanced logging interface. A series of helper functions with log levels and formatting methods are provided. It is usually recommended to use this in business logic to simplify logging code.")),(0,a.kt)("p",null,"We have implemented plug-ins to for some current logging library. You can also refer to their code for the log library adaptation you need:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/blob/main/log/std.go"},"std")," Kratos built-in stdout"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/log/fluent"},"fluent")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/log/zap"},"zap"))),(0,a.kt)("h2",{id:"metrics"},"Metrics"),(0,a.kt)("p",null,"In terms of monitoring alarms, you can report service statistics to the monitoring platform by implementing ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/blob/main/metrics/metrics.go"},"Metrics"),"."),(0,a.kt)("p",null,"Here is some plugins ready for use:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/metrics/datadog"},"datadog")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/go-kratos/kratos/tree/main/contrib/metrics/prometheus"},"prometheus"))),(0,a.kt)("h2",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"Kratos uses ",(0,a.kt)("a",{parentName:"p",href:"https://opentelemetry.io/"},"OpenTelemetry")," as the standard for distributed link tracing. You can configure the ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/middleware/tracing"},"tracing middleware")," when the client and server are initialized to connect the service to the link tracing platform (such as ",(0,a.kt)("a",{parentName:"p",href:"https://www.jaegertracing.io/"},"jaeger"),", etc.). In this way, the interface calling relationship, time-consuming, errors, etc. of the service are tracked."),(0,a.kt)("h2",{id:"load-balancing"},"Load Balancing"),(0,a.kt)("p",null,"Kratos has several built-in load ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/tree/main/selector"},"balancing algorithms"),", such as Weighted round robin (default), P2C, Random, etc. You can use them by configuring them during ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/selector"},"client initialization"),"."),(0,a.kt)("h2",{id:"ratelimit"},"Ratelimit"),(0,a.kt)("p",null,"Kratos provides ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/middleware/ratelimit"},"Ratelimit")," and ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/component/middleware/circuitbreaker"},"Circuitbreaker")," middleware, which are used to automatically limit traffic when microservices fail abnormally, improve service robustness, and avoid avalanches. The algorithms used by these two middleware can also be found in our availability algorithm repository ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/aegis"},"Aegis"),". These algorithms can be used directly independently of Kratos."),(0,a.kt)("h2",{id:"middleware"},"Middleware"),(0,a.kt)("p",null,"You can unify some common logic of the microservice interface through Kratos' middleware mechanism. For the function plugin mentioned above, you can write middleware that Kratos can use by implementing ",(0,a.kt)("inlineCode",{parentName:"p"},"Middleware"),"."),(0,a.kt)("p",null,"You can find a series of middleware provided by us in the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/kratos/tree/main/middleware"},"middleware")," directory of the repository."),(0,a.kt)("h2",{id:"plugins"},"Plugins"),(0,a.kt)("p",null,"In addition to the plugins mentioned above, we also provide some other plugins. Please visit ",(0,a.kt)("a",{parentName:"p",href:"https://go-kratos.dev/docs/getting-started/plugin"},"Plugins")),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)("p",null,"If you still have doubts about the use of some components after reading the documentation, or want to find some inspiration for writing projects in Kratos, we provide a lot of code for reference in the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/go-kratos/examples"},"examples repository")," directory."))}p.isMDXComponent=!0}}]);